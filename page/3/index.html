<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Seite 3 › Opportunities are reserved for those who are prepared</title>
  <meta name="author" content="蒙长圆">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Opportunities are reserved for those who are prepared"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Opportunities are reserved for those who are prepared" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header"><div class="meta inner">
  <h1><a href="/">Opportunities are reserved for those who are prepared</a></h1>
  <h2><a href="/"></a></h2>
  <nav id="main-nav">
    <ul>
      
      <li><a href="/about">About</a></li>
      
      <li><a href="/archives">Archives</a></li>
      
      <li><a href="/atom.xml">RSS</a></li>
      
    </ul>
    <div class="clearfix"></div>
  </nav>
</div>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/25/angular_8/">angular(八)</a></h1>
  

      
        <time datetime="2017-04-25T05:17:02.000Z">2017-04-25</time>
      
    </header>
    <div class="entry">
      
        <a id="more"></a>
<h1 id="正文开始"><a href="#正文开始" class="headerlink" title="正文开始"></a>正文开始</h1><p><center style="font-size: 30px"><code>路由DI</code></center></p>
<hr>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><h3 id="路由介绍"><a href="#路由介绍" class="headerlink" title="路由介绍"></a>路由介绍</h3><p>&#160; &#160; &#160; &#160;在谈路由机制前有必要先提一下现在比较流行的单页面应用，就是所谓的single page APP。为了实现无刷新的视图切换，我们通常会用ajax请求从后台取数据，然后套上HTML模板渲染在页面上，然而ajax的一个致命缺点就是导致浏览器后退按钮失效，尽管我们可以在页面上放一个大大的返回按钮，让用户点击返回来导航，但总是无法避免用户习惯性的点后退。解决此问题的一个方法是使用hash，监听hashchange事件来进行视图切换，另一个方法是用HTML5的history API，通过pushState()记录操作历史，监听popstate事件来进行视图切换，也有人把这叫pjax技术。基本流程如下：</p>
<p>&#160; &#160; &#160; &#160;如此一来，便形成了通过地址栏进行导航的深度链接（deeplinking ），也就是我们所需要的路由机制。通过路由机制，一个单页应用的各个视图就可以很好的组织起来了。</p>
<h3 id="ngRoute内容"><a href="#ngRoute内容" class="headerlink" title="ngRoute内容"></a>ngRoute内容</h3><p>&#160; &#160; &#160; &#160;ng的路由机制是靠ngRoute提供的，通过hash和history两种方式实现了路由，可以检测浏览器是否支持history来灵活调用相应的方式。ng的路由(ngRoute)是一个单独的模块，包含以下内容：</p>
<ul>
<li><p>服务$routeProvider用来定义一个路由表，即地址栏与视图模板的映射</p>
</li>
<li><p>服务$routeParams保存了地址栏中的参数，例如</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="attr">id</span> : <span class="number">1</span>, <span class="attr">name</span> : <span class="string">'tom'</span>&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>服务$route完成路由匹配，并且提供路由相关的属性访问及事件，如访问当前路由对应的controller</p>
</li>
<li><p>指令ngView用来在主视图中指定加载子视图的区域<br>　以上内容再加上$location服务，我们就可以实现一个单页面应用了。下面来看一下具体如何使用这些内容。</p>
</li>
</ul>
<h3 id="ng的路由机制"><a href="#ng的路由机制" class="headerlink" title="ng的路由机制"></a>ng的路由机制</h3><h4 id="第一步：引入文件和依赖"><a href="#第一步：引入文件和依赖" class="headerlink" title="第一步：引入文件和依赖"></a>第一步：引入文件和依赖</h4><p>&#160; &#160; &#160; &#160;ngRoute模块包含在一个单独的文件中，所以第一步需要在页面上引入这个文件，如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;script src=<span class="string">"http://code.angularjs.org/1.2.8/angular.min.js"</span> rel=<span class="string">"nofollow"</span>/&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://code.angularjs.org/1.2.8/angular-route.min.js"</span> <span class="attr">rel</span>=<span class="string">"nofollow"</span>/&gt;</span><span class="undefined"></span></span></div></pre></td></tr></table></figure>
<p>　<br>&#160; &#160; &#160; &#160;光引入还不够，我们还需在模块声明中注入对ngRoute的依赖，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'MyApp'</span>, [<span class="string">'ngRoute'</span>]);</div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;完成了这些，我们就可以在模板或是controller中使用上面的服务和指令了。下面我们需要定义一个路由表。</p>
<h4 id="第二步：定义路由表"><a href="#第二步：定义路由表" class="headerlink" title="第二步：定义路由表"></a>第二步：定义路由表</h4><p>&#160; &#160; &#160; &#160;$routeProvider提供了定义路由表的服务，它有两个核心方法，when(path,route)和otherwise(params)，先看一下核心中的核心when(path,route)方法。<br>&#160; &#160; &#160; &#160;when(path,route)方法接收两个参数，path是一个string类型，表示该条路由规则所匹配的路径，它将与地址栏的内容($location.path)值进行匹配。如果需要匹配参数，可以在path中使用冒号加名称的方式，如：path为/show/:name，如果地址栏是/show/tom，那么参数name和所对应的值tom便会被保存在$routeParams中，像这样：{name : tom}。我们也可以用<code>*</code>进行模糊匹配，如：/show*/:name将匹配/showInfo/tom。</p>
<p>&#160; &#160; &#160; &#160;route参数是一个object，用来指定当path匹配后所需的一系列配置项，包括以下内容：</p>
<ul>
<li>controller //function或string类型。在当前模板上执行的controller函数，生成新的scope；</li>
<li>controllerAs //string类型，为controller指定别名；</li>
<li>template //string或function类型，视图z所用的模板，这部分内容将被ngView引用；</li>
<li>templateUrl //string或function类型，当视图模板为单独的html文件或是使用了<br><code>&lt;script type=&quot;text/ng-template&quot;&gt;</code><br>定义模板时使用；</li>
<li>resolve //指定当前controller所依赖的其他模块；</li>
<li>redirectTo //重定向的地址。</li>
</ul>
<p>最简单情况，我们定义一个html文件为模板，并初始化一个指定的controller：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">emailRouteConfig</span>(<span class="params">$routeProvider</span>)</span>&#123;</div><div class="line">    $routeProvider.when(<span class="string">'/show'</span>, &#123;</div><div class="line">        <span class="attr">controller</span>: ShowController,</div><div class="line">        <span class="attr">templateUrl</span>: <span class="string">'show.html'</span></div><div class="line">    &#125;).</div><div class="line">    when(<span class="string">'/put/:name'</span>,&#123;</div><div class="line">       <span class="attr">controller</span>: PutController,</div><div class="line">       <span class="attr">templateUrl</span>: <span class="string">'put.html'</span></div><div class="line">    &#125;)</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;otherwise(params)方法对应路径匹配不到时的情况，这时候我们可以配置一个redirectTo参数，让它重定向到404页面或者是首页。</p>
<h4 id="第三步：在主视图模板中指定加载子视图的位置"><a href="#第三步：在主视图模板中指定加载子视图的位置" class="headerlink" title="第三步：在主视图模板中指定加载子视图的位置"></a>第三步：在主视图模板中指定加载子视图的位置</h4><p>&#160; &#160; &#160; &#160;我们的单页面程序都是局部刷新的，那这个“局部”是哪里呢，这就轮到ngView出马了，只需在模板中简单的使用此指令，在哪里用，哪里就是“局部”。例如：<br><code>&lt;div ng-view&gt;&lt;/div&gt;</code>　　或：<code>&lt;ng-view&gt;&lt;/ng-view&gt;</code>　</p>
<p>&#160; &#160; &#160; &#160;我们的子视图将会在此处被引入进来。完成这三步后，你的程序的路由就配置好了。</p>
<h3 id="路由示例"><a href="#路由示例" class="headerlink" title="路由示例"></a>路由示例</h3><p>&#160; &#160; &#160; &#160;下面我们将用一个例子（例09）来说明路由的使用方式及步骤：</p>
<p>1.为demoApp添加一个路由，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">demoApp.config([<span class="string">'$routeProvider'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$routeProvider</span>) </span>&#123;  </div><div class="line">$routeProvider.when(<span class="string">'/list'</span>, &#123;  </div><div class="line"><span class="attr">templateUrl</span>: <span class="string">'route/list.html'</span>,  </div><div class="line">  <span class="attr">controller</span>: <span class="string">'routeListController'</span></div><div class="line">&#125;).when(<span class="string">'/list/:id'</span>, &#123;  </div><div class="line">  <span class="attr">templateUrl</span>: <span class="string">'route/detail.html'</span>,</div><div class="line">   <span class="attr">controller</span>: <span class="string">'routeDetailController'</span></div><div class="line">  &#125;).otherwise(&#123;  </div><div class="line">        <span class="attr">redirectTo</span>: <span class="string">'/list'</span>  </div><div class="line">     &#125;);  </div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>/list 对应为：route/list.html页面，显示用户列表；/list/:id对应于route/detail.html页面，显示用户详细信息。</p>
<p>2.为list.html和detail.html分别声明Controller：routeListController和routeDetailController。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">demoApp.controller(<span class="string">'routeListController'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;  </div><div class="line">$scope.users = [&#123;<span class="attr">userId</span>:<span class="string">"zhangsan"</span>,<span class="attr">userName</span>:<span class="string">"张三"</span>,<span class="attr">userInfo</span>:<span class="string">"我是张三，我为自己带盐！"</span>&#125;,</div><div class="line">&#123;<span class="attr">userId</span>:<span class="string">"lisi"</span>,<span class="attr">userName</span>:<span class="string">"李四"</span>,<span class="attr">userInfo</span>:<span class="string">"我是李四，我为卿狂！"</span>&#125;,</div><div class="line">&#123;<span class="attr">userId</span>:<span class="string">"woshishui"</span>,<span class="attr">userName</span>:<span class="string">"我是谁"</span>,<span class="attr">userInfo</span>:<span class="string">"我是谁！我是谁！我是谁！"</span>&#125;];</div><div class="line"> </div><div class="line">&#125;);  </div><div class="line">demoApp.controller(<span class="string">'routeDetailController'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope, $routeParams, userService</span>) </span>&#123;  </div><div class="line">    $scope.userDetail = userService.getUser($routeParams.id);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>routeDetailController中如上面提到的一样，注入了userService服务，在这里直接拿来用。</p>
<p>3.创建list.html和detail.html页面，代码如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hr</span>/&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Route : List.html（用户列表页面）<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"user in users"</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://m.cnblogs.com/142260/3817063.html?full=1#/list/&#123;&#123; user.userId &#125;&#125;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"nofollow"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">hr</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Route : detail.html（用户详细信息页面）<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"color: red;"</span>&gt;</span>&#123;&#123;userDetail.userName&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>用户ID：&#123;&#123;userDetail.userId&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>用户名：&#123;&#123;userDetail.userName&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">用户简介：<span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;userDetail.userInfo&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://m.cnblogs.com/142260/3817063.html?full=1#/list"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"nofollow"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">a</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<ol>
<li>路由局部刷新位置：</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>AngularJS路由（Route） 示例<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-view</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/25/angular_6/">angular(六)</a></h1>
  

      
        <time datetime="2017-04-25T05:17:02.000Z">2017-04-25</time>
      
    </header>
    <div class="entry">
      
        <a id="more"></a>
<h1 id="正文开始"><a href="#正文开始" class="headerlink" title="正文开始"></a>正文开始</h1><p><center style="font-size: 30px"><code>服务</code></center></p>
<hr>
<h2 id="服务（service）"><a href="#服务（service）" class="headerlink" title="服务（service）"></a>服务（service）</h2><h3 id="服务介绍"><a href="#服务介绍" class="headerlink" title="服务介绍"></a>服务介绍</h3><p>&#160; &#160; &#160; &#160;服务这个概念其实并不陌生，在其他语言中如Java便有这样的概念，其作用就是对外提供某个特定的功能，如消息服务，文件压缩服务等，是一个独立的模块。ng的服务是这样定义的：</p>
<ul>
<li>Angular services are singletons objects or functions that carry out specific tasks common to web apps.</li>
</ul>
<p>它是一个单例对象或函数，对外提供特定的功能。<br>首先是一个单例，即无论这个服务被注入到任何地方，对象始终只有一个实例。<br>其次这与我们自己定义一个function然后在其他地方调用不同，因为服务被定义在一个模块中，所以其使用范围是可以被我们管理的。ng的避免全局变量污染意识非常强。</p>
<p>&#160; &#160; &#160; &#160;ng提供了很多内置的服务，可以到API中查看[<a href="http://docs.angularjs.org/api/。" target="_blank" rel="external">http://docs.angularjs.org/api/。</a>]<br>知道了概念，我们来拉一个service出来溜溜，看看到底是个什么用法。　<br>　<br>&#160; &#160; &#160; &#160;我们在controller中直接声明$location服务，这依靠ng的依赖注入机制。$location提供地址栏相关的服务，我们在此只是简单的获取当前的地址。</p>
<p>&#160; &#160; &#160; &#160;服务的使用是如此简单，我们可以把服务注入到controller、指令或者是其他服务中。</p>
<h3 id="自定义服务"><a href="#自定义服务" class="headerlink" title="自定义服务"></a>自定义服务</h3><p>&#160; &#160; &#160; &#160;如同指令一样，系统内置的服务以$开头，我们也可以自己定义一个服务。定义服务的方式有如下几种：</p>
<ul>
<li>使用系统内置的$provide服务；</li>
<li>使用Module的factory方法；</li>
<li>使用Module的service方法。</li>
</ul>
<p>&#160; &#160; &#160; &#160;下面通过一个小例子来分别试验一下。我们定义一个名为remoteData服务，它可以从远程获取数据，这也是我们在程序中经常使用的功能。不过我这里没有远程服务器，就写死一点数据模拟一下。<br>//使用$provide来定义</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//使用$provide来定义</span></div><div class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'MyApp'</span>, [], <span class="function"><span class="keyword">function</span>(<span class="params">$provide</span>) </span>&#123;</div><div class="line">    $provide.factory(<span class="string">'remoteData'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"> <span class="keyword">var</span> data = &#123;<span class="attr">name</span>:<span class="string">'n'</span>,<span class="attr">value</span>:<span class="string">'v'</span>&#125;;</div><div class="line">        <span class="keyword">return</span> data;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//使用factory方法</span></div><div class="line">app.factory(<span class="string">'remoteData'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> data = &#123;<span class="attr">name</span>:<span class="string">'n'</span>,<span class="attr">value</span>:<span class="string">'v'</span>&#125;;</div><div class="line">    <span class="keyword">return</span> data;</div><div class="line">&#125;);</div><div class="line"><span class="comment">//使用service方法</span></div><div class="line">app.service(<span class="string">'remoteData'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = <span class="string">'n'</span>;</div><div class="line">    <span class="keyword">this</span>.value = <span class="string">'v'</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;Module的factory和$provide的factory方法是一模一样的，从官网文档看它们其实就是一回事。至于Module内部是如何调用的，我此处并不打算深究，我只要知道怎么用就好了。</p>
<p>&#160; &#160; &#160; &#160;再看Module的service方法，它没有return任何东西，是因为service方法本身返回一个构造器，系统会自动使用new关键字来创建出一个对象。所以我们看到在构造器函数内可以使用this，这样调用该服务的地方便可以直接通过remoteData.name来访问数据了。</p>
<h3 id="管理服务的依赖关系"><a href="#管理服务的依赖关系" class="headerlink" title="管理服务的依赖关系"></a>管理服务的依赖关系</h3><p>&#160; &#160; &#160; &#160;服务与服务中间可以有依赖关系，例如我们这里定义一个名为validate的服务，它的作用是验证数据是否合法，它需要依赖我们从远程获取数据的服务remoteData。代码如下：</p>
<p> &#160; &#160; &#160; &#160;在factory的参数中，我们可以直接传入服务remoteData，ng的依赖注入机制便帮我们做好了其他工作。不过一定要保证这个参数的名称与服务名称一致，ng是根据名称来识别的。若参数的名次与服务名称不一致，你就必须显示的声明一下，方式如下：</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> app.factory(<span class="string">'validate'</span>,[<span class="string">'remoteData'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">remoteDataService</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(remoteDataService.name==<span class="string">'n'</span>)&#123;</div><div class="line">            alert(<span class="string">'验证通过'</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>  &#160; &#160; &#160; &#160;我们在controller中注入服务也是同样的道理，使用的名称需要与服务名称一致才可以正确注入。否则，你必须使用$inject来手动指定注入的服务。比如：</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">testC</span>(<span class="params">scope,rd</span>)</span>&#123;</div><div class="line">    scope.getData = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(<span class="string">'name：'</span>+rd.name+<span class="string">'   value：'</span>+rd.value);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">testC.$inject = [<span class="string">'$scope'</span>,<span class="string">'remoteData'</span>];</div></pre></td></tr></table></figure>
<p>   &#160; &#160; &#160; &#160;在controller中注入服务，也可以在定义controller时使用数组作为第二个参数，在此处<br>把服务注入进去，这样在函数体中使用不一致的服务名称也是可以的，不过要确保注入的顺序是一致的，如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">'testC'</span>,[<span class="string">'$scope'</span>,<span class="string">'remoteData'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope,rd</span>)</span>&#123;</div><div class="line">    $scope.getData = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(<span class="string">'name：'</span>+rd.name+<span class="string">'   value：'</span>+rd.value);</div><div class="line">    &#125;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<h3 id="自定义服务示例"><a href="#自定义服务示例" class="headerlink" title="自定义服务示例"></a>自定义服务示例</h3><p>&#160; &#160; &#160; &#160;接下来让我们看下例子（例08 自定义服务）代码，自定义userService服务：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">demoApp.factory(<span class="string">'userService'</span>, [<span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$http</span>) </span>&#123;</div><div class="line"><span class="keyword">var</span> doGetUser = <span class="function"><span class="keyword">function</span>(<span class="params">userId, path</span>) </span>&#123;</div><div class="line"><span class="comment">//return $http(&#123;</span></div><div class="line"><span class="comment">//method: 'JSONP',</span></div><div class="line"><span class="comment">//url: path</span></div><div class="line"><span class="comment">//&#125;);</span></div><div class="line"><span class="comment">/*手动指定数据*/</span></div><div class="line"><span class="keyword">var</span> data = &#123;<span class="attr">userId</span>:<span class="string">"woshishui"</span>,<span class="attr">userName</span>:<span class="string">"我是谁"</span>,<span class="attr">userInfo</span>:<span class="string">"我是谁！我是谁！"</span>&#125;;;</div><div class="line"><span class="keyword">if</span>(userId==<span class="string">'zhangsan'</span>)&#123;</div><div class="line">data = &#123;<span class="attr">userId</span>:<span class="string">"zhangsan"</span>,<span class="attr">userName</span>:<span class="string">"张三"</span>,<span class="attr">userInfo</span>:<span class="string">"我是张三，我为自己"</span>&#125;;</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(userId==<span class="string">'lisi'</span>)&#123;</div><div class="line">data = &#123;<span class="attr">userId</span>:<span class="string">"lisi"</span>,<span class="attr">userName</span>:<span class="string">"李四"</span>,<span class="attr">userInfo</span>:<span class="string">"我是李四，我为卿狂！"</span>&#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> data;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> &#123;</div><div class="line"><span class="comment">/*userService对外暴露的函数，可有多个*/</span></div><div class="line">getUser: <span class="function"><span class="keyword">function</span>(<span class="params">userId</span>) </span>&#123; </div><div class="line"><span class="keyword">return</span> doGetUser(userId, <span class="string">'../xxx/xxx.action'</span>); </div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;我们创建了一个只有一个方法的userService，getUser为这个服务从后台获取用户信息的函数，并且对外暴露。当然，由于这是一个静态的例子，无法访问后台，那么我们便制定其返回的数据。</p>
<p>&#160; &#160; &#160; &#160;然后我们把这个服务添加到我们的controller中。我们建立一个controller并加载（或者注入）userService作为运行时依赖，我们把service的名字作为参数传递给controller 函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">demoApp.controller(<span class="string">"test8Controller"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope,userService</span>)</span>&#123;</div><div class="line"><span class="comment">/*文章信息*/</span></div><div class="line">$scope.articles = [&#123;</div><div class="line"><span class="attr">title</span> : <span class="string">"爱飞像风"</span>,</div><div class="line"><span class="attr">userId</span> : <span class="string">"zhangsan"</span>,</div><div class="line"><span class="attr">userName</span> : <span class="string">"张三"</span></div><div class="line">&#125;,&#123;</div><div class="line"><span class="attr">title</span> : <span class="string">"无法停止的雨"</span>,</div><div class="line"><span class="attr">userId</span> : <span class="string">"lisi"</span>,</div><div class="line"><span class="attr">userName</span> : <span class="string">"李四"</span></div><div class="line">&#125;];</div><div class="line">$scope.showUserInfo = <span class="literal">false</span>;<span class="comment">//显示作者详细信息开关</span></div><div class="line">$scope.currentUser = &#123;&#125;; <span class="comment">//当前选中的作者</span></div><div class="line">$scope.getUserInfo = <span class="function"><span class="keyword">function</span>(<span class="params">userId</span>)</span>&#123;</div><div class="line">$scope.currentUser = userService.getUser(userId);</div><div class="line"><span class="comment">//调用 userService的getUser函数</span></div><div class="line">$scope.showUserInfo = <span class="literal">true</span>;</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//定时器：隐藏作者详细信息</span></div><div class="line">$scope.showUserInfo = <span class="literal">false</span>;</div><div class="line">&#125;,<span class="number">3000</span>);</div><div class="line">&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;我们的userService注入到我们的test8Controller后，我们就可以像使用其他服务（我们前面提到的$http服务）一样的使用userService了。</p>
<p>相关的HTML代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">/* View HTML*/</div><div class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">ng-repeat</span>=<span class="string">"article_ in articles"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">&#123;&#123;article_.title&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"nofollow"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">......</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-show</span>=<span class="string">"showUserInfo"</span>&gt;</span></div><div class="line">用户ID：&#123;&#123;currentUser.userId&#125;&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">用户名：&#123;&#123;currentUser.userName&#125;&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">用户简介：&#123;&#123;currentUser.userInfo&#125;&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/25/Token ，Cookie和Session的区别/">Token ，Cookie和Session的区别</a></h1>
  

      
        <time datetime="2017-04-25T05:17:02.000Z">2017-04-25</time>
      
    </header>
    <div class="entry">
      
        <a id="more"></a>
<h1 id="正文开始"><a href="#正文开始" class="headerlink" title="正文开始"></a>正文开始</h1><p><center style="font-size: 30px"><code>Token ，Cookie和Session的区别</code></center></p>
<hr>
<p>&#160; &#160; &#160; &#160;在做接口测试时，经常会碰到请求参数为token的类型，但是可能大部分测试人员对token，cookie，session的区别还是一知半解。为此我查阅大量的资料做了如下总结。 </p>
<p>&#160; &#160; &#160; &#160;此篇文章也许是最全最通俗的关于Token ，Cookie和Session的区别的文章，好好揣摩文章的每一个字，也许你会有更深的理解！</p>
<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>&#160; &#160; &#160; &#160;cookie 是一个非常具体的东西，指的就是浏览器里面能永久存储的一种数据，仅仅是浏览器实现的一种数据存储功能。</p>
<p>&#160; &#160; &#160; &#160;cookie由服务器生成，发送给浏览器，浏览器把cookie以kv形式保存到某个目录下的文本文件内，下一次请求同一网站时会把该cookie发送给服务器。由于cookie是存在客户端上的，所以浏览器加入了一些限制确保cookie不会被恶意使用，同时不会占据太多磁盘空间，所以每个域的cookie数量是有限的。</p>
<h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><p>&#160; &#160; &#160; &#160;session 从字面上讲，就是会话。这个就类似于你和一个人交谈，你怎么知道当前和你交谈的是张三而不是李四呢？对方肯定有某种特征（长相等）表明他就是张三。</p>
<p>&#160; &#160; &#160; &#160;session 也是类似的道理，服务器要知道当前发请求给自己的是谁。为了做这种区分，服务器就要给每个客户端分配不同的“身份标识”，然后客户端每次向服务器发请求的时候，都带上这个“身份标识”，服务器就知道这个请求来自于谁了。至于客户端怎么保存这个“身份标识”，可以有很多种方式，对于浏览器客户端，大家都默认采用 cookie 的方式。</p>
<p>&#160; &#160; &#160; &#160;服务器使用session把用户的信息临时保存在了服务器上，用户离开网站后session会被销毁。这种用户信息存储方式相对cookie来说更安全，可是session有一个缺陷：如果web服务器做了负载均衡，那么下一个操作请求到了另一台服务器的时候session会丢失。</p>
<h2 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h2><p>&#160; &#160; &#160; &#160;token的意思是“令牌”，是用户身份的验证方式，最简单的token组成:uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign(签名，由token的前几位+盐以哈希算法压缩成一定长的十六进制字符串，可以防止恶意第三方拼接token请求服务器)。还可以把不变的参数也放进token，避免多次查库！</p>
<h2 id="传统身份验证"><a href="#传统身份验证" class="headerlink" title="传统身份验证"></a>传统身份验证</h2><p>&#160; &#160; &#160; &#160;HTTP 是一种没有状态的协议，也就是它并不知道是谁是访问应用。这里我们把用户看成是客户端，客户端使用用户名还有密码通过了身份验证，不过下回这个客户端再发送请求时候，还得再验证一下。</p>
<p>&#160; &#160; &#160; &#160;解决的方法就是，当用户请求登录的时候，如果没有问题，我们在服务端生成一条记录，这个记录里可以说明一下登录的用户是谁，然后把这条记录的 ID 号发送给客户端，客户端收到以后把这个 ID 号存储在 Cookie 里，下次这个用户再向服务端发送请求的时候，可以带着这个 Cookie ，这样服务端会验证一个这个 Cookie 里的信息，看看能不能在服务端这里找到对应的记录，如果可以，说明用户已经通过了身份验证，就把用户请求的数据返回给客户端。</p>
<p>&#160; &#160; &#160; &#160;上面说的就是 Session，我们需要在服务端存储为登录的用户生成的 Session ，这些 Session 可能会存储在内存，磁盘，或者数据库里。我们可能需要在服务端定期的去清理过期的 Session 。</p>
<h2 id="基于-Token-的身份验证"><a href="#基于-Token-的身份验证" class="headerlink" title="基于 Token 的身份验证"></a>基于 Token 的身份验证</h2><p>&#160; &#160; &#160; &#160;使用基于 Token 的身份验证方法，在服务端不需要存储用户的登录记录。大概的流程是这样的：</p>
<ul>
<li>客户端使用用户名跟密码请求登录</li>
<li>服务端收到请求，去验证用户名与密码</li>
<li>验证成功后，服务端会签发一个 Token，再把这个 Token 发送给客户端</li>
<li>客户端收到 Token 以后可以把它存储起来，比如放在 Cookie 里或者 Local Storage 里</li>
<li>客户端每次向服务端请求资源的时候需要带着服务端签发的 Token</li>
<li>服务端收到请求，然后去验证客户端请求里面带着的Token，如果验证成功，就向客户端返回请求数据</li>
</ul>
<p>&#160; &#160; &#160; &#160;APP登录的时候发送加密的用户名和密码到服务器，服务器验证用户名和密码，如果成功，以某种方式比如随机生成32位的字符串作为token，存储到服务器中，并返回token到APP，以后APP请求时，凡是需要验证的地方都要带上该token，然后服务器端验证token，成功返回所需要的结果，失败返回错误信息，让他重新登录。其中服务器上token设置一个有效期，每次APP请求的时候都验证token和有效期。</p>
<p>&#160; &#160; &#160; &#160;那么我的问题来了： 1.服务器上的token存储到数据库中，每次查询会不会很费时。如果不存储到数据库，应该存储到哪里呢。 2.客户端得到的token肯定要加密存储的，发送token的时候再解密。存储到数据库还是配置文件呢？</p>
<p>&#160; &#160; &#160; &#160;token是个易失数据，丢了无非让用户重新登录一下，新浪微博动不动就让我重新登录，反正这事儿我是无所谓啦。 </p>
<p>&#160; &#160; &#160; &#160;所以如果你觉得普通的数据库表撑不住了，可以放到 MSSQL/<code>MySQL</code> 的内存表里（不过据说mysql的内存表性能提升有限），可以放到 Memcache里（讲真，这个是挺常见的策略），可以放到<code>Redis</code>里（我做过这样的实现），甚至可以放到 OpenResty 的变量字典里（只要你有信心不爆内存）。</p>
<p>&#160; &#160; &#160; &#160;token是个凭条，不过它比门票温柔多了，门票丢了重新花钱买，token丢了重新操作下认证一个就可以了，因此token丢失的代价是可以忍受的——前提是你别丢太频繁，要是让用户隔三差五就认证一次那就损失用户体验了。</p>
<p>&#160; &#160; &#160; &#160;基于这个出发点，如果你认为用数据库来保持token查询时间太长，会成为你系统的瓶颈或者隐患，可以放在内存当中。<br>比如memcached、redis，KV方式很适合你对token查询的需求。<br>&#160; &#160; &#160; &#160;这个不会太占内存，比如你的token是32位字符串，要是你的用户量在百万级或者千万级，那才多少内存。 </p>
<p>&#160; &#160; &#160; &#160;要是数据量真的大到单机内存扛不住，或者觉得一宕机全丢风险大，只要这个token生成是足够均匀的，高低位切一下分到不同机器上就行，内存绝对不会是问题。</p>
<p>&#160; &#160; &#160; &#160;客户端方面这个除非你有一个非常安全的办法，比如操作系统提供的隐私数据存储，那token肯定会存在泄露的问题。比如我拿到你的手机，把你的token拷出来，在过期之前就都可以以你的身份在别的地方登录。 </p>
<p>解决这个问题的一个简单办法:</p>
<p>1、在存储的时候把token进行对称加密存储，用时解开。<br>2、将请求URL、时间戳、token三者进行合并加盐签名，服务端校验有效性。<br>这两种办法的出发点都是：窃取你存储的数据较为容易，而反汇编你的程序hack你的加密解密和签名算法是比较难的。然而其实说难也不难，所以终究是防君子不防小人的做法。话说加密存储一个你要是被人扒开客户端看也不会被喷明文存储……<br>方法1它拿到存储的密文解不开、方法2它不知道你的签名算法和盐，两者可以结合食用。<br>但是如果token被人拷走，他自然也能植入到自己的手机里面，那到时候他的手机也可以以你的身份来用着，这你就瞎了。<br>于是可以提供一个让用户可以主动expire一个过去的token类似的机制，在被盗的时候能远程止损。</p>
<p>在网络层面上token明文传输的话会非常的危险，所以建议一定要使用HTTPS，并且把token放在post body里。</p>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/25/angular-4/">angularjs(四)</a></h1>
  

      
        <time datetime="2017-04-25T05:17:02.000Z">2017-04-25</time>
      
    </header>
    <div class="entry">
      
        <h1 id="正文开始"><a href="#正文开始" class="headerlink" title="正文开始"></a>正文开始</h1><p><center style="font-size: 30px"><code>过滤器</code></center></p>
<hr>
<h2 id="1-过滤器"><a href="#1-过滤器" class="headerlink" title="1.过滤器"></a>1.过滤器</h2><p>&#160; &#160; &#160; &#160;过滤器<code>（filter）</code>正如其名，作用就是接收一个输入，通过某个规则进行处理，然后返回处理后的结果。主要用在数据的格式化上，例如获取一个数组中的子集，对数组中的元素进行排序等。过滤器通常是伴随标记来使用的，将你model中的数据格式化为需要的格式。表单的控制功能主要涉及到数据验证以及表单控件的增强。ng内置了一些过滤器，它们是：</p>
<p>currency(货币)、date(日期)、filter(子串匹配)、json(格式化json对象)、limitTo(限制个数)、lowercase(小写)、uppercase(大写)、number(数字)、orderBy(排序)。</p>
<h3 id="过滤器使用方式"><a href="#过滤器使用方式" class="headerlink" title="过滤器使用方式"></a>过滤器使用方式</h3><p>&#160; &#160; &#160; &#160;总共九种。除此之外还可以自定义过滤器，这个就强大了，可以满足任何要求的数据处理。Filter还是很简单的，需要明白的是内置的<code>filter</code>如何使用，以及自己如何定义一个<code>filter</code>。</p>
<h4 id="filter的两种使用方法："><a href="#filter的两种使用方法：" class="headerlink" title="filter的两种使用方法："></a>filter的两种使用方法：</h4><h5 id="1-在模板中使用filter"><a href="#1-在模板中使用filter" class="headerlink" title="1. 在模板中使用filter"></a>1. 在模板中使用filter</h5><p>我们可以直接在双括号中使用<code>filter</code>，跟在表达式后面用 | 分割，语法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; expression | filter &#125;&#125;</div></pre></td></tr></table></figure>
<p>也可以多个<code>filter</code>连用，上一个filter的输出将作为下一个filter的输入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; expression | filter1 | filter2 | ... &#125;&#125;</div></pre></td></tr></table></figure>
<p>filter可以接收参数，参数用 : 进行分割，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; expression | filter:argument1:argument2:... &#125;&#125;</div></pre></td></tr></table></figure>
<p>除了对双括号中的数据进行格式化，我们还可以在指令中使用filter，例如先对数组array进行过滤处理，然后再循环输出：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">ng-repeat</span>=<span class="string">"a in array | filter "</span>&gt;</span></div></pre></td></tr></table></figure>
<h5 id="2-在controller和service中使用filter"><a href="#2-在controller和service中使用filter" class="headerlink" title="2. 在controller和service中使用filter"></a>2. 在controller和service中使用filter</h5><p>&#160; &#160; &#160; &#160;我们的js代码中也可以使用过滤器，方式就是我们熟悉的依赖注入，例如我要在controller中使用currency过滤器，只需将它注入到该controller中即可，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">'testC'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope,currencyFilter</span>)</span>&#123;</div><div class="line">    $scope.num = currencyFilter(<span class="number">123534</span>);  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>　</p>
<p>在模板中使用就可以直接输出$123,534.00了！在服务中使用filter也是同样的道理。</p>
<p>&#160; &#160; &#160; &#160;如果你要在controller中使用多个filter，并不需要一个一个注入吗，ng提供了一个$filter服务可以来调用所需的filter，你只需注入一个$filter就够了，使用方法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">'testC'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope,$filter</span>)</span>&#123;</div><div class="line">    $scope.num = $filter(<span class="string">'currency'</span>)(<span class="number">123534</span>);　　</div><div class="line">    $scope.date = $filter(<span class="string">'date'</span>)(<span class="keyword">new</span> <span class="built_in">Date</span>());  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以达到同样的效果。好处是你可以方便使用不同的filter了。</p>
<h2 id="3-ng的内置过滤器"><a href="#3-ng的内置过滤器" class="headerlink" title="3. ng的内置过滤器"></a>3. ng的内置过滤器</h2><p>&#160; &#160; &#160; &#160;ng内置了九种过滤器，使用方法都非常简单，看文档即懂。不过为了以后不去翻它的文档，我在这里还是做一个详细的记录。<br>&#160; &#160; &#160; &#160;currency(货币)、date(日期)、filter(子串匹配)、json(格式化json对象)、limitTo(限制个数)、lowercase(小写)、uppercase(大写)、number(数字)、orderBy(排序)</p>
<h3 id="1-currency-货币处理"><a href="#1-currency-货币处理" class="headerlink" title="1. currency (货币处理)"></a>1. currency (货币处理)</h3><p>&#160; &#160; &#160; &#160;使用currency可以将数字格式化为货币，默认是美元符号，你可以自己传入所需的符号，例如我传入人民币：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;num | currency : <span class="string">'￥'</span>&#125;&#125;</div></pre></td></tr></table></figure>
<h3 id="2-date-日期格式化"><a href="#2-date-日期格式化" class="headerlink" title="2. date (日期格式化)"></a>2. date (日期格式化)</h3><p>&#160; &#160; &#160; &#160;原生的js对日期的格式化能力有限，ng提供的date过滤器基本可以满足一般的格式化要求。用法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;date | date : <span class="string">'yyyy-MM-dd hh:mm:ss EEEE'</span>&#125;&#125;</div></pre></td></tr></table></figure>
<p>　<br>&#160; &#160; &#160; &#160;参数用来指定所要的格式，y M d h m s E 分别表示 年 月 日 时 分 秒 星期，你可以自由组合它们。也可以使用不同的个数来限制格式化的位数。另外参数也可以使用特定的描述性字符串，例如“shortTime”将会把时间格式为12:05 pm这样的。ng提供了八种描述性的字符串，个人觉得这些有点多余，我完全可以根据自己的意愿组合出想要的格式，不愿意去记这么多单词~</p>
<h3 id="3-filter-匹配子串"><a href="#3-filter-匹配子串" class="headerlink" title="3. filter(匹配子串)"></a>3. filter(匹配子串)</h3><p>&#160; &#160; &#160; &#160;这个名叫filter的filter。用来处理一个数组，然后可以过滤出含有某个子串的元素，作为一个子数组来返回。可以是字符串数组，也可以是对象数组。如果是对象数组，可以匹配属性的值。它接收一个参数，用来定义子串的匹配规则。下面举个例子说明一下参数的用法，我用现在特别火的几个孩子定义了一个数组：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$scope.childrenArray = [</div><div class="line">        &#123;<span class="attr">name</span>:<span class="string">'kimi'</span>,<span class="attr">age</span>:<span class="number">3</span>&#125;,</div><div class="line">        &#123;<span class="attr">name</span>:<span class="string">'cindy'</span>,<span class="attr">age</span>:<span class="number">4</span>&#125;,</div><div class="line">        &#123;<span class="attr">name</span>:<span class="string">'anglar'</span>,<span class="attr">age</span>:<span class="number">4</span>&#125;,</div><div class="line">        &#123;<span class="attr">name</span>:<span class="string">'shitou'</span>,<span class="attr">age</span>:<span class="number">6</span>&#125;,</div><div class="line">        &#123;<span class="attr">name</span>:<span class="string">'tiantian'</span>,<span class="attr">age</span>:<span class="number">5</span>&#125;</div><div class="line">];</div><div class="line"></div><div class="line">    $scope.func = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">return</span> e.age&gt;<span class="number">4</span>;&#125;&#123;&#123; childrenArray | filter : <span class="string">'a'</span> &#125;&#125; <span class="comment">//匹配属性值中含有a的</span></div><div class="line">    &#123;&#123; childrenArray | filter : <span class="number">4</span> &#125;&#125;  <span class="comment">//匹配属性值中含有4的</span></div><div class="line">    &#123;&#123; childrenArray | filter : &#123;<span class="attr">name</span> : <span class="string">'i'</span>&#125; &#125;&#125; <span class="comment">//参数是对象，匹配name属性中含有i的</span></div><div class="line">    &#123;&#123;childrenArray | filter : func &#125;&#125;  <span class="comment">//参数是函数，指定返回age&gt;4的</span></div></pre></td></tr></table></figure>
<h3 id="4-json-格式化json对象"><a href="#4-json-格式化json对象" class="headerlink" title="4. json(格式化json对象)"></a>4. json(格式化json对象)</h3><p>&#160; &#160; &#160; &#160;json过滤器可以把一个js对象格式化为json字符串，没有参数。这东西有什么用呢，我一般也不会在页面上输出一个json串啊，官网说它可以用来进行调试，嗯，是个不错的选择。或者，也可以用在js中使用，作用就和我们熟悉的JSON.stringify()一样。用法超级简单：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; jsonTest | json&#125;&#125;</div></pre></td></tr></table></figure>
<h3 id="5-limitTo-限制数组长度或字符串长度"><a href="#5-limitTo-限制数组长度或字符串长度" class="headerlink" title="5. limitTo(限制数组长度或字符串长度)"></a>5. limitTo(限制数组长度或字符串长度)</h3><p>&#160; &#160; &#160; &#160;limitTo过滤器用来截取数组或字符串，接收一个参数用来指定截取的长度，如果参数是负值，则从数组尾部开始截取。个人觉得这个filter有点鸡肋，首先只能从数组或字符串的开头/尾部进行截取，其次，js原生的函数就可以代替它了，看看怎么用吧：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; childrenArray | limitTo : <span class="number">2</span> &#125;&#125;  <span class="comment">//将会显示数组中的前两项</span></div></pre></td></tr></table></figure>
<p>　　</p>
<h3 id="6-lowercase-小写"><a href="#6-lowercase-小写" class="headerlink" title="6. lowercase(小写)"></a>6. lowercase(小写)</h3><p>&#160; &#160; &#160; &#160;把数据转化为全部小写。太简单了，不多解释。同样是很鸡肋的一个filter，没有参数，只能把整个字符串变为小写，不能指定字母。怎么用我都懒得写了。</p>
<h3 id="7-uppercase-大写"><a href="#7-uppercase-大写" class="headerlink" title="7. uppercase(大写)"></a>7. uppercase(大写)</h3><p>同上。</p>
<h3 id="8-number-格式化数字"><a href="#8-number-格式化数字" class="headerlink" title="8. number(格式化数字)"></a>8. number(格式化数字)</h3><p>&#160; &#160; &#160; &#160;number过滤器可以为一个数字加上千位分割，像这样，123,456,789。同时接收一个参数，可以指定float类型保留几位小数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; num | number : <span class="number">2</span> &#125;&#125;</div></pre></td></tr></table></figure>
<p>　　</p>
<h3 id="9-orderBy-排序"><a href="#9-orderBy-排序" class="headerlink" title="9. orderBy(排序)"></a>9. orderBy(排序)</h3><p>&#160; &#160; &#160; &#160;orderBy过滤器可以将一个数组中的元素进行排序，接收一个参数来指定排序规则，参数可以是一个字符串，表示以该属性名称进行排序。可以是一个函数，定义排序属性。还可以是一个数组，表示依次按数组中的属性值进行排序（若按第一项比较的值相等，再按第二项比较），还是拿上面的孩子数组举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;&#123;&#123; childrenArray | orderBy : 'age' &#125;&#125;&lt;/div&gt;      //按age属性值进行排序，若是-age，则倒序</div><div class="line">&lt;div&gt;&#123;&#123; childrenArray | orderBy : orderFunc &#125;&#125;&lt;/div&gt;   //按照函数的返回值进行排序</div><div class="line">&lt;div&gt;&#123;&#123; childrenArray | orderBy : ['age','name'] &#125;&#125;&lt;/div&gt;  //如果age相同，按照name进行排序　　内置的过滤器介绍</div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;完了，写的我都快睡着了。。。正如你所看到的，ng内置的过滤器也并不是万能的，事实上好多都比较鸡肋。更个性化的需求就需要我们来定义自己的过滤器了，下面来看看如何自定义过滤器。</p>
<h2 id="3-自定义过滤器及示例"><a href="#3-自定义过滤器及示例" class="headerlink" title="3.自定义过滤器及示例"></a>3.自定义过滤器及示例</h2><p>&#160; &#160; &#160; &#160;filter的自定义方式也很简单，使用module的filter方法，返回一个函数，该函数接收<br>输入值，并返回处理后的结果。话不多说，我们来写一个看看。比如我需要一个过滤器，它可以返回一个数组中下标为奇数的元素，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">app.filter(<span class="string">'odditems'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">inputArray</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> array = [];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;inputArray.length;i++)&#123;</div><div class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>!==<span class="number">0</span>)&#123;</div><div class="line">                array.push(inputArray[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> array;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;格式就是这样，你的处理逻辑就写在内部的那个闭包函数中。你也可以让自己的过滤器接收参数，参数就定义在return的那个函数中，作为第二个参数，或者更多个参数也可以。</p>
<p>&#160; &#160; &#160; &#160;格式就是这样，你的处理逻辑就写在内部的那个闭包函数中。你也可以让自己的过滤器接收参数，参数就定义在return的那个函数中，作为第二个参数，或者更多个参数也可以。<br>自定义过滤器实例（例04）:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* View html */</span></div><div class="line">First name：&lt;input ng-model=<span class="string">"user.firstName"</span>/&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></div><div class="line">Last  name：&lt;input ng-model=<span class="string">"user.lastName"</span>/&gt; <span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></div><div class="line">First name：&#123;&#123;user.firstName&#125;&#125;      Last  name：&#123;&#123;user.lastName&#125;&#125; &lt;br/&gt;</div><div class="line">Fullname：&#123;&#123;user | flFullname&#125;&#125;&lt;br/&gt;</div><div class="line">Fullname：&#123;&#123;user | flFullname:<span class="string">"－"</span>&#125;&#125;&lt;br/&gt;</div><div class="line">Fullname：&#123;&#123;user | flFullname:<span class="string">"•"</span> | uppercase &#125;&#125;</div><div class="line"><span class="comment">/* Controller js */</span></div><div class="line">demoApp.filter(<span class="string">"flFullname"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">user, sep</span>) </span>&#123;</div><div class="line">        sep = sep || <span class="string">" "</span>;</div><div class="line">        user = user || &#123;&#125;;</div><div class="line">        fullName = <span class="string">""</span>;</div><div class="line">        <span class="keyword">if</span>(user.firstName)&#123;fullName += user.firstName;&#125;</div><div class="line">        <span class="keyword">if</span>(user.lastName)&#123;fullName = fullName + sep + user.lastName;&#125;</div><div class="line">        <span class="keyword">if</span>(fullName &amp;&amp; fullName.length&gt;<span class="number">0</span>)&#123;<span class="keyword">return</span> fullName;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;<span class="keyword">return</span> <span class="string">""</span>;&#125;</div><div class="line">    &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/25/angular-3/">angularjs(三)</a></h1>
  

      
        <time datetime="2017-04-25T05:17:02.000Z">2017-04-25</time>
      
    </header>
    <div class="entry">
      
        <h1 id="正文开始"><a href="#正文开始" class="headerlink" title="正文开始"></a>正文开始</h1><p><center style="font-size: 30px"><code>功能介绍</code></center></p>
<hr>
<h2 id="1-数据绑定"><a href="#1-数据绑定" class="headerlink" title="1.数据绑定"></a>1.数据绑定</h2><p>&#160; &#160; &#160; &#160;AngularJS的双向数据绑定，意味着你可以在<code>Mode(JS)</code>中改变数据，而这些变动立刻就会自动出现在<code>View</code>上，<code>反之亦然</code>。即：一方面可以做到model变化驱动了DOM中元素变化，另一方面也可以做到DOM元素的变化也会影响到Model。<br>&#160; &#160; &#160; &#160;在我们使用jQuery的时候，代码中会大量充斥类似这样的语句：var val = $(‘#id’).val(); $(‘#id’).html(str);等等，即频繁的DOM操作（读取和写入），其实我们的最终目的并不是要操作DOM，而是要实现业务逻辑。ng的绑定将让你摆脱DOM操作，只要模板与数据通过声明进行了绑定，两者将随时保持同步，最新的数据会实时显示在页面中，页面中用户修改的数据也会实时被记录在数据模型中。<br><strong>从View到Controller再到View的数据交互（例01）：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;html ng-app=<span class="string">"demoApp"</span>&gt;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=<span class="string">"text"</span> ng-model=<span class="string">"user.name"</span> placeholder=<span class="string">"请输入名称"</span>/&gt;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Hello, &#123;&#123; user.name &#125;&#125;！</div></pre></td></tr></table></figure>
<p><code>关键</code>： ng-app 、 ng-model 和 { {user.name } }<br><code>首先</code>： <html>元素的ng-app属性。标识这个DOM里面的内容将启用AngularJS应用。<br><code>其次</code>：告诉AngularJS，对页面上的“user.name” 这个Model进行双向数据绑定。<br><code>第三</code>：告诉AngularJS，在“”这个指令模版上显示“user.name”这个Model的数据。<br><strong>从Server到Controller再到View的数据交互（例02）：</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"demoApp"</span>&gt;</span></div></pre></td></tr></table></figure></html></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>  <span class="attr">ng-controller</span>=<span class="string">"demoController"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"user.name"</span> <span class="attr">disabled</span>=<span class="string">"disabled"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"nofollow"</span>&gt;</span>获取名字<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">demoApp.controller(<span class="string">"demoController"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$http, $scope</span>)</span>&#123;</div><div class="line">$scope. getAjaxUser = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">// $http.get(&#123;url:"../xxx.action"&#125;).success(function(data)&#123;</span></div><div class="line"><span class="comment">// $scope.user= data;</span></div><div class="line"><span class="comment">// &#125;);</span></div><div class="line">$scope.user = &#123;<span class="string">"name"</span>:<span class="string">"从JOSN中获取的名称"</span>,<span class="string">"age"</span>:<span class="number">22</span>&#125;;</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>改变$scope中的user，View也会自动更新。</p>
<h2 id="2-scopes、module、controller"><a href="#2-scopes、module、controller" class="headerlink" title="2.scopes、module、controller"></a>2.scopes、module、controller</h2><h3 id="2-1-scopes"><a href="#2-1-scopes" class="headerlink" title="2.1 scopes"></a>2.1 scopes</h3><p>&#160; &#160; &#160; &#160;$scope是一个把view（一个DOM元素）连结到controller上的对象。在我们的MVC结构里，这个 $scope 将成为model，它提供一个绑定到DOM元素（以及其子元素）上的excecution context。</p>
<p>&#160; &#160; &#160; &#160;尽管听起来有点复杂，但 $scope 实际上就是一个JavaScript对象，controller和view都可以访问它，所以我们可以利用它在两者间传递信息。在这个 $scope 对象里，我们既存储数据，又存储将要运行在view上的函数。</p>
<p>&#160; &#160; &#160; &#160;每一个Angular应用都会有一个 $rootScope。这个 $rootScope 是最顶级的scope，它对应着含有 ng-app 指令属性的那个DOM元素。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.run(<span class="function"><span class="keyword">function</span>(<span class="params">$rootScope</span>) </span>&#123; $rootScope.name = <span class="string">"张三"</span>; &#125;);</div></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;如果页面上没有明确设定 $scope ，Angular 就会把数据和函数都绑定到这里， 第一部分中的例子就是靠这一点成功运行的。<br>&#160; &#160; &#160; &#160;这样，我们就可以在view的任何地方访问这个name属性，使用模版表达式，像这样：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;name&#125;&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-2-module"><a href="#2-2-module" class="headerlink" title="2.2 module"></a>2.2 module</h3><p>&#160; &#160; &#160; &#160;首先需要明确一下模板的概念。在我还不知道有模板这个东西的时候，曾经用js拼接出很长的HTML字符串，然后append到页面中，这种方式想想真是又土又笨。后来又看到可以把HTML代码包裹在一个&lt;script&gt;标签中当作模板，然后按需要取来使用。<br>&#160; &#160; &#160; &#160;在ng中，模板十分简单，它就是我们页面上的HTML代码，不需要附加任何额外的东西。在模板中可以使用各种指令来增强它的功能，这些指令可以让你把模板和数据巧妙的绑定起来。<br>在&lt;html&gt;标签上多了一个属性ng-app=”MyApp”，它的作用就是用来指定ng的作用域是在&lt;html&gt;标签以内部分。在js中，我们调用angular对象的module方法来声明一个模块，模块的名字和ng-app的值对应。这样声明一下就可以让ng运行起来了。<br>示例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"demoApp"</span>&gt;</span></div><div class="line">var demoApp = angular.module('demoApp', []);</div></pre></td></tr></table></figure></p>
<h3 id="2-3-ng-controller"><a href="#2-3-ng-controller" class="headerlink" title="2.3 ng-controller"></a>2.3 ng-controller</h3><p>&#160; &#160; &#160; &#160;要明确创建一个$scope 对象，我们就要给DOM元素安上一个<code>controlle</code>r对象，使用的是ng-controller 指令属性：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"MyController"</span>&gt;</span> &#123;&#123; person.name &#125;&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;ng-controller指令给所在的DOM元素创建了一个新的$scope 对象，并将这个$scope 对象包含进外层DOM元素的$scope 对象里。在上面的例子里，这个外层DOM元素的$scope 对象，就是$rootScope 对象。这个scope链是这样的：</p>
<p>&#160; &#160; &#160; &#160;所有scope都遵循原型继承（prototypal inheritance），这意味着它们都能访问父scope们。对任何属性和方法，如果AngularJS在当前scope上找不到，就会到父 scope上去找，如果在父scope上也没找到，就会继续向上回溯，一直到$rootScope 上。即如果controller是多层嵌套的，就会从最里面一直往外找，这个scope链是这样的：</p>
<p>&#160; &#160; &#160; &#160;唯一的例外：有些指令属性可以选择性地创建一个独立的scope，让这个scope不继承它的父scope们，这个会在指令详解中说明。</p>
<h3 id="4-3-ajax"><a href="#4-3-ajax" class="headerlink" title="4.3 ajax"></a>4.3 ajax</h3><p>&#160; &#160; &#160; &#160;$http 服务是AngularJS的核心服务之一，它帮助我们通过XMLHttpRequest对象或JSONP与远程HTTP服务进行交流。<br>&#160; &#160; &#160; &#160;$http 服务是这样一个函数：它接受一个设置对象，其中指定了如何创建HTTP请求；它将返回一个承诺（*参考JavaScript异步编程的promise模式），其中提供两个方法： s<code>uccess</code>方法和<code>error</code>方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">demoApp.controller(<span class="string">"demoController"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$http, $scope</span>)</span>&#123;</div><div class="line">$scope. getAjaxUser = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">$http.get(&#123;<span class="attr">url</span>:<span class="string">"../xxx.action"</span>&#125;).success(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">alert(data);</div><div class="line">&#125;).error(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">Alert(“出错了！”);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>AngularJS的AJAX与jquery等框架的AJAX基本一致，这里就不多说了。</p>
<h3 id="4-4表达式"><a href="#4-4表达式" class="headerlink" title="4.4表达式"></a>4.4表达式</h3><p>&#160; &#160; &#160; &#160;ng中的表达式与javascript表达式类似但是不可以划等号，它是ng自己定义的一套模式。表达式可以作为指令的值，如<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ng-modle=<span class="string">"people.name"</span>、ng-click=<span class="string">"showMe()"</span></div></pre></td></tr></table></figure></p>
<p> ，看起来是如此像字符串，故而也叫字符串表达式。也可以在标记中使用表达式，如<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;<span class="number">1</span>+<span class="number">2</span>&#125;&#125;</div></pre></td></tr></table></figure></p>
<p> ，或者与过滤器一起使用<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;<span class="number">1</span>+<span class="number">2</span> | currency&#125;&#125;</div></pre></td></tr></table></figure></p>
<p> 。在框架内部，字符串不会简单的使用<code>eval()</code>来执行，而是有一个专门的$parse服务来处理。在ng表达式中不可以使用循环语句、判断语句，事实上在模板中使用复杂的表达式也是一个不推荐的做法，这样视图与逻辑就混杂在一起了<br>我们在使用其他模板库时，一般都会有模板的循环输出、分支输出、逻辑判断等类似的控制。<br>要想理解指令属性的运作，我们必须先理解表达式。在之前的例子里我们已经见过表达式，例如<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; user.name &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>请查看例03、例04、例05。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; <span class="number">8</span> + <span class="number">1</span> &#125;&#125; <span class="number">9</span></div><div class="line">&#123;&#123; person &#125;&#125; &#123;<span class="string">"name"</span>:<span class="string">"Ari Lerner"</span>&#125;</div><div class="line">&#123;&#123; <span class="number">10</span> * <span class="number">3.3</span> | currency &#125;&#125; $<span class="number">33.00</span></div></pre></td></tr></table></figure></p>
<p>表达式粗略来看有点像 eval(javascript) 的结果。它们会经过Angular.js的处理，从而拥有以下重要而<code>独特</code>的性质：<br><code>1</code> 所有表达式都在scope这个context里被执行，因此可以使用所有本地 $scope 中的变量。<br><code>2</code> 如果一个表达式的执行导致类型错误或引用错误，这些错误将不会被抛出。<br><code>3</code> 表达式里不允许任何控制函数流程的功能（如if/else等条件语句）<br><code>4</code> 表达式可接受一个或多个串联起来的过滤器。</p>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/25/angular-2/">angularjs(二)</a></h1>
  

      
        <time datetime="2017-04-25T05:17:02.000Z">2017-04-25</time>
      
    </header>
    <div class="entry">
      
        <a id="more"></a>
<h1 id="正文开始"><a href="#正文开始" class="headerlink" title="正文开始"></a>正文开始</h1><p><center style="font-size: 30px"><code>AugularJS特性</code></center></p>
<hr>
<p>&#160; &#160; &#160; &#160;AngularJS是一个新出现的强大客户端技术，提供给大家的一种开发强大应用的方式。这种方式利用并且扩展HTML，CSS和javascript，并且弥补了它们的一些非常明显的不足。本应该使用HTML来实现而现在由它开发的动态一些内容。</p>
<p>AngularJS有<code>五个</code>最重要的功能和特性：</p>
<h2 id="特性一：双向的数据绑定"><a href="#特性一：双向的数据绑定" class="headerlink" title="特性一：双向的数据绑定"></a>特性一：双向的数据绑定</h2><p>&#160; &#160; &#160; &#160;数据绑定可能是AngularJS最酷最实用的特性。它能够帮助你避免书写大量的初始代码从而节约开发时间。一个典型的web应用可能包含了80%的代码用来处理，查询和监听DOM。数据绑定是的代码更少，你可以专注于你的应用。</p>
<p>&#160; &#160; &#160; &#160;我们想象一下Model是你的应用中的简单事实。你的Model是你用来读取或者更新的部分。数据绑定指令提供了你的Model投射到view的方法。这些投射可以无缝的，毫不影响的应用到web应用中。</p>
<p>&#160; &#160; &#160; &#160;传统来说，当model变化了。 开发人员需要手动处理DOM元素并且将属性反映到这些变化中。这个一个双向的过程。一方面，model变化驱动了DOM中元素变化，另一方面，DOM元素的变化也会影响到Model。这个在用户互动中更加复杂，因为开发人员需要处理和解析<br>这些互动，然后融合到一个model中，并且更新View。这是一个手动的复杂过程，当一个应用非常庞大的时候，将会是一件非常费劲的事情。</p>
<p>这里肯定有更好的解决方案！那就是AngularJS的双向数据绑定，能够同步DOM和Model等等。<br>这里有一个非常简单的例子，用来演示一个input输入框和&lt; h1&gt;元素的双向绑定(例01)：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>angular双向数据绑定<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-app</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;content&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">          <span class="comment">&lt;!-- 因为使用了双向绑定content指向的都是同一个值，所以h1的内容就是text输入框的内容 --&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">ng-model</span>=<span class="string">"content"</span>&gt;</span></div><div class="line">          <span class="comment">&lt;!-- 设置双向绑定 --&gt;</span></div><div class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://code.angularjs.org/angular-1.0.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="特性二：模板"><a href="#特性二：模板" class="headerlink" title="特性二：模板"></a>特性二：模板</h2><p>&#160; &#160; &#160; &#160;在AngularJS中，一个模板就是一个HTML文件。但是HTML的内容扩展了，包含了很多帮助你映射model到view的内容。</p>
<p>&#160; &#160; &#160; &#160;HTML模板将会被浏览器解析到DOM中。DOM然后成为AngularJS编译器的输入。AngularJS将会遍历DOM模板来生成一些指导，即，directive（指令）。所有的指令都负责针对view来设置数据绑定。</p>
<p>&#160; &#160; &#160; &#160;我们要理解AuguarJS并不把模板当做String来操作。输入AngularJS的是DOM而非string。数据绑定是DOM变化，不是字符串的连接或者innerHTML变化。使用DOM作为输入，而不是字符串，是AngularJS区别于其它的框架的最大原因。使用DOM允许你扩展指令词汇并且可以创建你自己的指令，甚至开发可重用的组件。</p>
<p>&#160; &#160; &#160; &#160;最大的好处是为设计师和开发者创建了一个紧密的工作流。设计师可以像往常一样开发标签，然后开发者拿过来添加上功能，通过数据绑定将会使得这个过程非常简单。<br>这里有一个例子，我们使用ng-repeat指令来循环图片数组并且加入img模板，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">AlbumCtrl</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">    scope.images = [</div><div class="line">        &#123;<span class="string">"image"</span>:<span class="string">"img/image_01.png"</span>, <span class="string">"description"</span>:<span class="string">"Image 01 description"</span>&#125;,</div><div class="line">        &#123;<span class="string">"image"</span>:<span class="string">"img/image_02.png"</span>, <span class="string">"description"</span>:<span class="string">"Image 02 description"</span>&#125;,</div><div class="line">        &#123;<span class="string">"image"</span>:<span class="string">"img/image_03.png"</span>, <span class="string">"description"</span>:<span class="string">"Image 03 description"</span>&#125;,</div><div class="line">        &#123;<span class="string">"image"</span>:<span class="string">"img/image_04.png"</span>, <span class="string">"description"</span>:<span class="string">"Image 04 description"</span>&#125;,</div><div class="line">        &#123;<span class="string">"image"</span>:<span class="string">"img/image_05.png"</span>, <span class="string">"description"</span>:<span class="string">"Image 05 description"</span>&#125;</div><div class="line">    ];</div><div class="line">&#125;</div><div class="line">&lt;div ng-controller=<span class="string">"AlbumCtrl"</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"image in images"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">ng-src</span>=<span class="string">"http://wangyuxuan.win/&#123;&#123;image.thumbnail&#125;&#125;"</span> <span class="attr">rel</span>=<span class="string">"nofollow"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;这里还有一件事值得提一句，AngularJS并不强制你学习一个新的语法或者从你的应用中提出你的模板。</p>
<h2 id="特性三：MVC"><a href="#特性三：MVC" class="headerlink" title="特性三：MVC"></a>特性三：MVC</h2><p>&#160; &#160; &#160; &#160;针对客户端应用开发AngularJS吸收了传统的MVC基本原则。MVC或者Model-View-Controll设计模式针对不同的人可能意味不同的东西。AngularJS并不执行传统意义上的MVC，更接近于MVVM（Moodel-View-ViewModel)。</p>
<p><code>Model</code></p>
<p>&#160; &#160; &#160; &#160;model是应用中的简单数据。一般是简单的javascript对象。这里没有必要继承框架的classes，使用proxy对象封装或者使用特别的setter/getter方法来访问。事实上我们处理vanilla javascript的方法就是一个非常好的特性，这种方法使得我们更少使用应用的原型。</p>
<p><code>ViewModel</code></p>
<p>&#160; &#160; &#160; &#160;viewmodel是一个用来提供特别数据和方法从而维护指定view的对象。<br>viewmodel是$scope的对象，只存在于AnguarJS的应用中。$scope只是一个简单的js对象，这个对象使用简单的API来侦测和广播状态变化。</p>
<p><code>Controller</code></p>
<p>&#160; &#160; &#160; &#160;controller负责设置初始状态和参数化$scope方法用以控制行为。需要指出的controller并不保存状态也不和远程服务互动。</p>
<p><code>View</code></p>
<p>&#160; &#160; &#160; &#160;view是AngularJS解析后渲染和绑定后生成的HTML 。这个部分帮助你创建web应用的架构。$scope拥有一个针对数据的参考，controller定义行为，view处理布局和互动。</p>
<h2 id="特性四：服务和依赖注入"><a href="#特性四：服务和依赖注入" class="headerlink" title="特性四：服务和依赖注入"></a>特性四：服务和依赖注入</h2><p>&#160; &#160; &#160; &#160;AngularJS服务其作用就是对外提供某个特定的功能。</p>
<p>&#160; &#160; &#160; &#160;AngularJS拥有内建的依赖注入（DI）子系统，可以帮助开发人员更容易的开发，理解和测试应用。</p>
<p>&#160; &#160; &#160; &#160;DI允许你请求你的依赖，而不是自己找寻它们。比如，我们需要一个东西，DI负责找创建并且提供给我们。</p>
<p>&#160; &#160; &#160; &#160;为了而得到核心的AngularJS服务，只需要添加一个简单服务作为参数，AngularJS会侦测并且提供给你：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">EditCtrl</span>(<span class="params">$scope, $location, $routeParams</span>) </span>&#123;</div><div class="line">     <span class="comment">// Something clever here...</span></div><div class="line">&#125;</div><div class="line">你也可以定义自己的服务并且让它们注入：</div><div class="line">angular.module(<span class="string">'MyServiceModule'</span>, []).</div><div class="line">    factory(<span class="string">'notify'</span>, [<span class="string">'$window'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">win</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">        win.alert(msg);</div><div class="line">    &#125;;</div><div class="line">&#125;]);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myController</span>(<span class="params">scope, notifyService</span>) </span>&#123;</div><div class="line">    scope.callNotify = <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">        notifyService(msg);</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">myController.$inject = [<span class="string">'$scope'</span>, <span class="string">'notify'</span>];</div></pre></td></tr></table></figure></p>
<h2 id="特性五：指令（Directives）"><a href="#特性五：指令（Directives）" class="headerlink" title="特性五：指令（Directives）"></a>特性五：指令（Directives）</h2><p>&#160; &#160; &#160; &#160;指令是我个人最喜欢的特性。你是不是也希望浏览器可以做点儿有意思的事情？那么AngularJS可以做到。</p>
<p>&#160; &#160; &#160; &#160;指令可以用来创建自定义的标签。它们可以用来装饰元素或者操作DOM属性。可以作为标签、属性、注释和类名使用。</p>
<p>这里是一个例子，它监听一个事件并且针对的更新它的$scope ，如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">myModule.directive(<span class="string">'myComponent'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">mySharedService</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">restrict</span>: <span class="string">'E'</span>,</div><div class="line">        <span class="attr">controller</span>: <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $attrs, mySharedService</span>) </span>&#123;</div><div class="line">            $scope.$on(<span class="string">'handleBroadcast'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                $scope.message = <span class="string">'Directive: '</span> + mySharedService.message;</div><div class="line">            &#125;);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">replace</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">template</span>: <span class="string">'&lt;input&gt;'</span></div><div class="line">    &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>然后，你可以使用这个自定义的directive来使用：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;my-component ng-model=<span class="string">"message"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>使用一系列的组件来创建你自己的应用将会让你更方便的添加，删除和更新功能。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结:"></a>小结:</h2><p>个人推荐一个学习angular.js的网站<a href="http://www.apjs.net/" target="_blank" rel="external">http://www.apjs.net/</a></p>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/23/js对象的原型与继承方式/">js对象的原型与继承方式</a></h1>
  

      
        <time datetime="2017-04-23T13:04:04.000Z">2017-04-23</time>
      
    </header>
    <div class="entry">
      
        <a id="more"></a>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="js对象的原型："><a href="#js对象的原型：" class="headerlink" title="js对象的原型："></a>js对象的原型：</h2><ol>
<li><p>原型：就是指函数的prototype属性所引用的 对象</p>
</li>
<li><p>原型的作用：实现数据的共享</p>
</li>
<li><p>本质：原型 就是 对象；当创建函数时，就已经创建原型–js解析器创建的默认原型，会给默认原型添加一个constructor属性，该属性指回函数。</p>
</li>
<li><p>如果手动替换掉了默认的原型，那么constructor属性会丢失。此时，若该属性具有一定的开发意义，就将其手动添加上，并且给其正确的指向。</p>
</li>
<li><p>继承的概念<br> 就是指对象有权去访问另一个对象上的属性和方法。</p>
</li>
<li><p>继承的实现<br> 继承的基本实现：让一个对象 能 直接访问到另一个对象上的成员</p>
</li>
<li><p>继承实现方式</p>
<ul>
<li><p>原型式：a: 在默认原型上 去添加 想要访问的属性和要调用的方法；<br>b: 将默认的原型替换掉。然后原型变成一个新的对象，之后创建的对象，就继承自新的原型。</p>
</li>
<li><p>混入式：从jQuery的extend方法里总结的一种继承实现</p>
</li>
</ul>
</li>
</ol>
<h2 id="混入式继承"><a href="#混入式继承" class="headerlink" title="混入式继承"></a>混入式继承</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 在ES6，Object.assign()</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params"> target </span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> args = <span class="built_in">arguments</span>,</div><div class="line">            i = <span class="number">1</span>,</div><div class="line">            l = args.length,</div><div class="line">            obj;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> k;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> ( target == <span class="literal">undefined</span> ) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> ( ; i &lt; l; i++ ) &#123;</div><div class="line">        obj = args[ i ];</div><div class="line">        <span class="keyword">for</span> ( k <span class="keyword">in</span> obj ) &#123;</div><div class="line">            <span class="keyword">if</span> ( obj.hasOwnProperty( k ) ) &#123;</div><div class="line">                target[ k ] = obj [ k ];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> target;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>应用场景：</p>
<p>&#160; &#160; &#160; &#160;在实际开发时，如果需要将参数以对象形式出入，并且在实际处理时需要将该对象的属性 在添加给其他对象来存储，那么在此时此景，就可以使用混入式继承来实现。</p>
<p>注意：<strong>虽然混入式继承不能实现代码的复用，但是在特定的情况下可以提高开发效率</strong></p>
<h2 id="ES5提供的方法"><a href="#ES5提供的方法" class="headerlink" title="ES5提供的方法"></a>ES5提供的方法</h2><p>扩展：Object.defineProperty(); Object.defineProperties()</p>
<p>Object.create( parent, [options] );</p>
<p>功能：创建一个对象，并继承自parent参数。<br>可以通过第二个参数，给新对象初始化一些属性和方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> parent = &#123;</div><div class="line">    <span class="attr">say</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log( <span class="string">'hello, girl. I am '</span> + <span class="keyword">this</span>.name + <span class="string">'. i am '</span> + <span class="keyword">this</span>.age + <span class="string">' years old. make friend, OK?'</span> );</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> child = <span class="built_in">Object</span>.create( parent, &#123;</div><div class="line">    <span class="string">'name'</span>: &#123;</div><div class="line">        <span class="attr">value</span>: <span class="string">'jingjing'</span>,</div><div class="line">        <span class="attr">writable</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    <span class="string">'age'</span>: &#123;</div><div class="line">        <span class="attr">value</span>: <span class="number">22</span>,</div><div class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">&#125; );</div><div class="line"></div><div class="line">child.say();</div></pre></td></tr></table></figure>
<p>优点：非常方便的创建了一个对象，并继承了其他对象；</p>
<p>缺点：类型比较弱。</p>
<p>兼容处理：</p>
<ol>
<li><p>创建新对象</p>
</li>
<li><p>新对象的原型 是 方法的parent参数</p>
</li>
<li><p>在兼容处理时，该方法从哪里来的 最终就添加到哪里去</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// &lt;!-- 如果浏览器不支持该方法 --&gt;</span></div><div class="line"><span class="keyword">if</span> ( !<span class="built_in">Object</span>.create )&#123;</div><div class="line">    <span class="built_in">Object</span>.create = <span class="function"><span class="keyword">function</span> (<span class="params"> parent </span>) </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        &#125;</div><div class="line">        parent.constructor = F;</div><div class="line">        F.prototype = parent;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> F();</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/22/正则表达式/">正则表达式</a></h1>
  

      
        <time datetime="2017-04-22T15:11:12.000Z">2017-04-22</time>
      
    </header>
    <div class="entry">
      
        <a id="more"></a>
<h2 id="正则处理"><a href="#正则处理" class="headerlink" title="正则处理"></a>正则处理</h2><p>(正则，就是用来匹配的.)( regular expression)<br>正则是由  正常的匹配字符  与  元字符( 通配符, 或格式化匹配 )  构成的.<br>因此正则表达式学习的就是元字符:</p>
<h3 id="常用元字符"><a href="#常用元字符" class="headerlink" title="常用元字符:"></a>常用元字符:</h3><pre><code>1) 基本元字符: .    []     |      ()
            2) 限定元字符: +   *    ?   {n}   {n,}  {n,m}
            3) 首尾元字符:  ^         $
            4) 简写元字符: \d        \D
                           \w        \W
                           \s        \S
</code></pre><h3 id="贪婪模式"><a href="#贪婪模式" class="headerlink" title="贪婪模式:"></a>贪婪模式:</h3><p>正则默认匹配尽可能匹配到的东西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&apos;1234567890&apos;</div><div class="line">/\d+\d+\d+/</div></pre></td></tr></table></figure></p>
<p>取消贪婪模式: 在指定的限定元字符后面添加 ? 表示取消该限定元字符的贪婪模式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&apos;1234567890&apos;</div><div class="line">/\d+?\d+\d+/</div></pre></td></tr></table></figure>
<h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p> 分组( group ), 在正则中使用 () 来分组</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">/(\d+)(\d+)(\d+)/</div><div class="line">正则分组有一个规律, 从左往右数左圆括号, 编号从 1 开始,</div><div class="line">每一个与左圆括号结合的右圆括号构成一个区域. 该区域就是指定的组.</div><div class="line"> 1     2    3</div><div class="line">/(\d+)(\d+)(\d+)/</div><div class="line"> 1 2 3      4</div><div class="line">/(a(b(c)d))e(f)/</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">正则中有一个特殊的元字符不参与分组, 就是 (?: )</div><div class="line"> 1     2      3</div><div class="line">/(a(?:b(c)d))e(f)/</div></pre></td></tr></table></figure>
<h2 id="正则常用方法"><a href="#正则常用方法" class="headerlink" title="正则常用方法:"></a>正则常用方法:</h2><p>   正则是为了匹配字符串的, 那么可以匹配就可以提取, 可以提取就可以替换.</p>
<h3 id="test"><a href="#test" class="headerlink" title="test"></a>test</h3><p>语法: 正则表达式.test( 字符串 ) =&gt; boolean<br>验证数据常常被用到.</p>
<h3 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h3><p>提取字符串使用的<br>语法: 正则表达式.exec( 字符串 ) =&gt; Array<br>注意: 数组中的第 0 个元素则为匹配到的结果, 如果没有匹配到结果那么返回 null.<br>默认只匹配提取从左往右找出来的第零个匹配项.</p>
<h3 id="全局模式-g"><a href="#全局模式-g" class="headerlink" title="全局模式 -g"></a>全局模式 -g</h3><p>如果要循环获得一个字符串中某一个匹配的字符串:<br>1) 正则需要开启全局模式( 右边写上 g, 例如 /e/g )<br>2) 依次调用 exec 方法会获得第0次, 第1次, 第2次的匹配结果, 直到找不到为止, 返回 null.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">eg:</div><div class="line">            <span class="keyword">var</span> str = <span class="string">'ab12c12345d1ef123g45h67ijk3456lm89n'</span>;  <span class="comment">// 将所有的数字取出来, 存储到数组中</span></div><div class="line">            <span class="keyword">var</span> rnum = <span class="regexp">/\d+/g</span>;   <span class="comment">// 开启全局模式</span></div><div class="line">            <span class="keyword">var</span> arr = [],        <span class="comment">// 存取到的数字字符串</span></div><div class="line">                m;               <span class="comment">// match</span></div><div class="line">            <span class="keyword">while</span> ( ( m = rnum.exec( str ) ) != <span class="literal">null</span> ) &#123;</div><div class="line">                arr.push( m[ <span class="number">0</span> ] - <span class="number">0</span> );</div><div class="line">            &#125;</div></pre></td></tr></table></figure>
<h3 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h3><p>语法: 字符串.replace( 正则表达式, ‘字符串’ ) =&gt; 新的字符串</p>
<h4 id="eg-1"><a href="#eg-1" class="headerlink" title="eg:1"></a>eg:1</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="string">'a------------a---a------a-----a--a'</span>.replace( <span class="regexp">/-+/g</span>, <span class="string">'-'</span> );</div><div class="line">=&gt; a-a-a-a-a-a</div></pre></td></tr></table></figure>
<p>正则的 replace 方法中支持 组引用, 和组替换</p>
<h4 id="eg-2"><a href="#eg-2" class="headerlink" title="eg:2"></a>eg:2</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="string">'a123bc'</span>.replace( <span class="regexp">/(\d+)/</span>, <span class="string">'$1'</span> ) =&gt; a123bc</div><div class="line"><span class="string">'a123bc'</span>.replace( <span class="regexp">/(\d+)/</span>, <span class="string">'$1$1'</span> ) =&gt; a123123bc</div></pre></td></tr></table></figure>
<h4 id="eg-3"><a href="#eg-3" class="headerlink" title="eg:3"></a>eg:3</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="string">'2017-4-21'</span>.replace( <span class="regexp">/(\d&#123;4&#125;)-(\d&#123;1,2&#125;)-(\d&#123;1,2&#125;)/</span>, <span class="string">'$1年$2月$3日'</span> )</div></pre></td></tr></table></figure>
<h4 id="eg-4"><a href="#eg-4" class="headerlink" title="eg:4"></a>eg:4</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">/index.php/teacher/<span class="function"><span class="params">list</span> =&gt;</span> teacher-list</div><div class="line"></div><div class="line">/.+\/(.+)\/(.+)/</div><div class="line"></div><div class="line"><span class="string">'/index.php/teacher/list'</span>.replace( <span class="regexp">/.+\/(.+)\/(.+)/</span>, <span class="string">'.$1-$2'</span> )</div></pre></td></tr></table></figure>
<h4 id="replace高级用法"><a href="#replace高级用法" class="headerlink" title="replace高级用法"></a>replace高级用法</h4><p>语法: 字符串.replace( 正则表达式, 回调函数 ) =&gt; 替换后的字符串</p>
<p>在执行的时候, 每次匹配到的结果, 都会将回调函数调用一次, 将回调函数的返回值 替换到 匹配项的位置.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="string">'a123b456c'</span>.replace( <span class="regexp">/\d+/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">'A'</span>; &#125; )</div></pre></td></tr></table></figure>
<p>注意, 每次匹配到结果都会调用一次这个函数, 同时将匹配到的结果( 数组 )作为参数分散的传入到函数中.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'a123b456c'</span>.replace( <span class="regexp">/\d+/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params"> m </span>) </span>&#123; <span class="keyword">return</span> m; &#125; )</div><div class="line">=&gt; a123b456c</div></pre></td></tr></table></figure></p>
<p>带有回调函数的 replace 可以替代前面的所有 replace 的功能<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> <span class="string">'a------------a---a------a-----a--a'</span>.replace( <span class="regexp">/-+/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">'-'</span>; &#125; );</div><div class="line"></div><div class="line"><span class="string">'2017-4-21'</span>.replace( <span class="regexp">/(\d&#123;4&#125;)-(\d&#123;1,2&#125;)-(\d&#123;1,2&#125;)/</span>, <span class="function"><span class="keyword">function</span> (<span class="params"> _, year, month, day </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> year + <span class="string">'年'</span> + month + <span class="string">'月'</span> + day + <span class="string">'日'</span>;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure></p>
<h3 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h3><p>将驼峰命名规则的字符串, 转换为带有连字符的字符串.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="string">'getElementsByTagName'</span> =&gt; <span class="string">'get-elements-by-tag-name'</span>.</div><div class="line"><span class="comment">//原生的实现方式</span></div><div class="line"><span class="keyword">var</span> c = <span class="string">'??'</span>;</div><div class="line">c.charAt( <span class="number">0</span> ).toUppercase() == c.charAt( <span class="number">0</span> )</div><div class="line"></div><div class="line">c.charCode( <span class="number">0</span> ) 在 <span class="number">65</span> 与 <span class="number">91</span> 之间</div><div class="line"></div><div class="line"><span class="comment">//利用了正则的实现方式</span></div><div class="line">str.replace( <span class="regexp">/([a-z])([A-Z])/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params"> _, a, b </span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a + <span class="string">'-'</span> + b.toLowerCase();</div><div class="line">&#125;).replace( <span class="regexp">/([a-z])([A-Z])/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params"> _, a, b </span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a + <span class="string">'-'</span> + b.toLowerCase();</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//反过来, get-elements-by-tag-name =&gt; getElementsByTagName</span></div><div class="line"></div><div class="line">str.replace( <span class="regexp">/(.)-(.)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params"> _, a, b </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> a + b.toUpperCase();</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>对于字符串处理来说，学会正则表达在日常开发中能够更快捷的处理各种字符串！</p>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>





  <article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/2017/04/22/模块化开发的介绍与使用/">模块化开发的介绍与使用</a></h1>
  

      
        <time datetime="2017-04-22T07:53:54.000Z">2017-04-22</time>
      
    </header>
    <div class="entry">
      
        <a id="more"></a>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文:"></a>正文:</h1><h2 id="模块的概念："><a href="#模块的概念：" class="headerlink" title="模块的概念："></a>模块的概念：</h2><p>所谓的模块, 在泛指的情况下与组件含义相同. 都是指组成一个完整系统一个零件或单体.</p>
<p>&#160; &#160; &#160; &#160;所谓的前端模块化是为了使得前端页面中的内容可以复用( 思想, 将页面看成一个个零件组合而成 )</p>
<h3 id="js-原生不支持模块化-什么意思-："><a href="#js-原生不支持模块化-什么意思-：" class="headerlink" title="js 原生不支持模块化( 什么意思? )："></a>js 原生不支持模块化( 什么意思? )：</h3><p>1.每一个页面模块可以提供独立的 js 代码. 混合到一起后 数据无法共享或容易造成全局污染.</p>
<p>2.每一个 js 为了更好的使用会引入其他的 js. 那么不好统一处理依赖问题.</p>
<p>3.利用组件分解页面以后, 所有的数据是独立的,资源路径不容易统一维护.</p>
<h3 id="因此需要提供一种-js-支持的-组件化方案："><a href="#因此需要提供一种-js-支持的-组件化方案：" class="headerlink" title="因此需要提供一种 js 支持的 组件化方案："></a>因此需要提供一种 js 支持的 组件化方案：</h3><p>nodejs 平台中原生支持了 js 的模块化( CommonJS 规则 )</p>
<p>&#160; &#160; &#160; &#160;在 node 中如果要使用第三方的 js 代码, 就需要使用 require 来加载该代码( 此时与 html 中的 script 标签的功能一样 )</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> code = <span class="built_in">require</span>( <span class="string">'模块的名字'</span> )</div></pre></td></tr></table></figure>
<p>将 node 的模块化思想移植到前端之中( 浏览器中 )</p>
<p>&#160; &#160; &#160; &#160;node 模块资源有一个特点, 就是存储在本地.<br>node 在设计 api 的时候将 大部分 api 都设计成异步的. 但是require 是同步的.</p>
<p>&#160; &#160; &#160; &#160;因此在浏览器中不能使用该规则的. 阻塞, 网络等一些列问题.所以为了解决这一系列的问题，引入了下面几种概念</p>
<h3 id="AMD的概念："><a href="#AMD的概念：" class="headerlink" title="AMD的概念："></a>AMD的概念：</h3><p>引入了一个新的规则 AMD( asynchronous module definition ), 开发了 require.js<br>下载地址：[<a href="https://github.com/requirejs/requirejs" target="_blank" rel="external">https://github.com/requirejs/requirejs</a>]</p>
<p>在 require 很成功情况下, 它的语法有点问题( 提前加载 )<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">define( [ 所有的依赖 ], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"><span class="comment">// 自己的代码</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>特点是在执行自己的代码之前, 所有依赖必须加载完毕</p>
<h3 id="CMD的概念："><a href="#CMD的概念：" class="headerlink" title="CMD的概念："></a>CMD的概念：</h3><p>玉伯提出了按需的加载的思想, 引入了 CMD ( common module definition )规则, 开发了 sea.js<br>下载地址：[<a href="https://github.com/seajs/seajs" target="_blank" rel="external">https://github.com/seajs/seajs</a>]</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">define( <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"><span class="comment">// 要用某一个模块的时候 require( '....' )</span></div><div class="line"><span class="built_in">require</span>.async( ... )</div><div class="line"><span class="comment">// 自己的代码</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>思想就发生了变化<br>编写代码不在统一的写道一个文件中, 而是写道不同的文件中, 称为模块<br>然后再页面中组合成一个完整的代码来使用.</p>
<h2 id="模块的定义与加载"><a href="#模块的定义与加载" class="headerlink" title="模块的定义与加载"></a>模块的定义与加载</h2><h3 id="首先引入require-js"><a href="#首先引入require-js" class="headerlink" title="首先引入require.js"></a>首先引入require.js</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/requirejs/require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="如何定义模块"><a href="#如何定义模块" class="headerlink" title="如何定义模块"></a>如何定义模块</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">define( <span class="string">'模块名'</span>, [ <span class="string">'依赖模块1'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">  </span>)  </span>&#123;</div><div class="line">    <span class="comment">// 自己的模块</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第一个参数是如果写了称该模块为表示的是匿名模块<br>第二个参数是一个数组, 里面存储路径 )<br>第三个参数是回调函数, 就如果有加载依<br>注意: 一个模块应该定义到一个文件中, 一个文件中只允许有一个模块.</p>
<h3 id="加载模块的语法"><a href="#加载模块的语法" class="headerlink" title="加载模块的语法"></a>加载模块的语法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>( [ <span class="string">'模块名'</span> ], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  &#125; )</div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;加载模块的时候可以依次加载一个模块, 也可以依次加载多个模块, 使用数组描述即可<br>第二个参数一般不需要, 它表示的是如果模块加载完成以后要立即使用, 则写在函数中.</p>
<h2 id="定义自己的模块和引用"><a href="#定义自己的模块和引用" class="headerlink" title="定义自己的模块和引用"></a>定义自己的模块和引用</h2><h3 id="定义自己的模块"><a href="#定义自己的模块" class="headerlink" title="定义自己的模块"></a>定义自己的模块</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">     define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'wyx'</span>);</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'hehe'</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="引入自己的模块"><a href="#引入自己的模块" class="headerlink" title="引入自己的模块"></a>引入自己的模块</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>自定义模块的引入<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"node_modules/requirejs/require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="comment">//可以引入自己自定义的模块 第二个参数是这个对象的变量</span></div><div class="line">    <span class="built_in">require</span>([<span class="string">'./zdy'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(name);</div><div class="line">    &#125;);</div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="模块的路径问题"><a href="#模块的路径问题" class="headerlink" title="模块的路径问题"></a>模块的路径问题</h2><h3 id="默认路径："><a href="#默认路径：" class="headerlink" title="默认路径："></a>默认路径：</h3><p>&#160; &#160; &#160; &#160;RequireJS以一个相对于baseUrl的地址来加载所有的代码.页面顶层标签含有一个特殊的属性data-main，require.js使用它来启动脚本加载过程，而baseUrl一般设置到与该属性相一致的目录。下列示例中展示了baseUrl的设置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;!--This sets the baseUrl to the <span class="string">"scripts"</span> directory, and</div><div class="line">    loads a script that will have a <span class="built_in">module</span> ID <span class="keyword">of</span> <span class="string">'main'</span>--&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">"scripts/main.js"</span> <span class="attr">src</span>=<span class="string">"scripts/require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>&#160; &#160; &#160; &#160;baseUrl亦可通过RequireJS config手动设置。如果没有显式指定config及data-main，则默认的baseUrl为包含RequireJS的那个HTML页面的所属目录。</p>
<p>&#160; &#160; &#160; &#160;RequireJS默认假定所有的依赖资源都是js脚本，因此无需在module ID上再加”.js”后缀，RequireJS在进行module ID到path的解析时会自动补上后缀。你可以通过paths config设置一组脚本，这些有助于我们在使用脚本时码更少的字。</p>
<p>&#160; &#160; &#160; &#160;有时候你想避开”baseUrl + paths”的解析过程，而是直接指定加载某一个目录下的脚本。此时可以这样做：如果一个module ID符合下述规则之一，其ID解析会避开常规的”baseUrl + paths”配置，而是直接将其加载为一个相对于当前HTML文档的脚本：</p>
<p>以 “.js” 结束.</p>
<p>以 “/“ 开始.</p>
<p>包含 URL 协议, 如 “http:” or “https:”</p>
<p>&#160; &#160; &#160; &#160;一般来说，最好还是使用baseUrl及”paths” config去设置module ID。它会给你带来额外的灵活性，如便于脚本的重命名、重定位等。 同时，为了避免凌乱的配置，最好不要使用多级嵌套的目录层次来组织代码，而是要么将所有的脚本都放置到baseUrl中.</p>
<h3 id="自定义路径加载"><a href="#自定义路径加载" class="headerlink" title="自定义路径加载"></a>自定义路径加载</h3><h4 id="使用配置项"><a href="#使用配置项" class="headerlink" title="使用配置项"></a>使用配置项</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  <span class="built_in">require</span>.config(&#123;</div><div class="line">     <span class="attr">baseUrl</span>: <span class="string">'/参考路径'</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="配置路径的短名字"><a href="#配置路径的短名字" class="headerlink" title="配置路径的短名字"></a>配置路径的短名字</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">                <span class="attr">baseUrl</span>: <span class="string">'基础路径'</span>,</div><div class="line">                <span class="attr">paths</span>: &#123;</div><div class="line">                    短名字: <span class="string">'长路径'</span></div><div class="line">        &#125;</div><div class="line"> &#125;)</div></pre></td></tr></table></figure>
<h3 id="命名模块的使用"><a href="#命名模块的使用" class="headerlink" title="命名模块的使用"></a>命名模块的使用</h3><p>在定义模块的时候使用语法:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">define( <span class="string">'模块名'</span>, [ 依赖 ], callback )</div></pre></td></tr></table></figure></p>
<p>具名模块, 或命名模块 named module<br>必须配置路径, 在配置短名字的时候必须与模块的名字一样</p>
<h3 id="如何导出依赖问题"><a href="#如何导出依赖问题" class="headerlink" title="如何导出依赖问题"></a>如何导出依赖问题</h3><p>&#160; &#160; &#160; &#160;如果一个代码它依赖于另一个模块, 但是这个代码中没有定义依赖的方式, 那么就使用<br>        添加一个 shim 的属性, 在属性中添加 deps 属性, 该值是一个数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">shim: &#123;</div><div class="line">          短名字: &#123;</div><div class="line">          <span class="attr">deps</span>: [ <span class="string">'依赖的模块'</span> ]</div><div class="line">      &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h3 id="非模块的问题"><a href="#非模块的问题" class="headerlink" title="非模块的问题"></a>非模块的问题</h3><p>&#160; &#160; &#160; &#160;如果一个 js 库不是一个模块( 一个单纯的 js 库, 返回一个公共对象, 另一种就是为了完成某一个事情的 js 库, 不返回任何内容, 但是依赖于某一个库 )<br>如果是返回对象的 js 库</p>
<h4 id="使用配置"><a href="#使用配置" class="headerlink" title="使用配置"></a>使用配置</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">shim: &#123;</div><div class="line">        短名字: &#123;</div><div class="line">            <span class="attr">exports</span>: <span class="string">'名字'</span></div><div class="line">         &#125;</div><div class="line">     &#125;</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&#160; &#160; &#160; &#160;写在最后的话，本文没有介绍AMD模式(sea.js)的使用方法，使用方法与require.js的使用方法大致相同<br>，但是sea.js是采用了按需加载的模式(懒加载)，只有在调用时导入模块即可，<br>具体用法如下</p>
<h4 id="引入jquery为例"><a href="#引入jquery为例" class="headerlink" title="引入jquery为例"></a>引入jquery为例</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</div><div class="line">    <span class="comment">//引用jQuery模块</span></div><div class="line">    <span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'jquery'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>

      
    </div>
      
        
        
      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>






<nav id="pagination">
  
    <a href="/page/2/" class="alignleft prev">Vorherige Seite</a>
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Suche">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Neueste Artikel</h3>
  <ul class="entry">
    
      <li>
        <a href="/2017/12/02/text/">test</a>
      </li>
    
      <li>
        <a href="/2017/11/06/javascript风格指南/">Airbnb JavaScript风格指南（）</a>
      </li>
    
      <li>
        <a href="/2017/09/20/webpack从入门到真实项目配置/">webpack：从入门到真实项目配置</a>
      </li>
    
      <li>
        <a href="/2017/09/11/js 的正则表达式/">js 的正则表达式</a>
      </li>
    
      <li>
        <a href="/2017/09/07/剖析Vue原理&amp;实现双向绑定MVVM/">剖析Vue原理&amp;实现双向绑定MVVM</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Kategorien</h3>
  <ul class="entry">
  
    <li><a href="/categories/AJAX/">AJAX</a><small>1</small></li>
  
    <li><a href="/categories/AngularJS/">AngularJS</a><small>7</small></li>
  
    <li><a href="/categories/CSS3/">CSS3</a><small>1</small></li>
  
    <li><a href="/categories/ES6/">ES6</a><small>1</small></li>
  
    <li><a href="/categories/VueJS/">VueJS</a><small>9</small></li>
  
    <li><a href="/categories/eslint/">eslint</a><small>1</small></li>
  
    <li><a href="/categories/javascript/">javascript</a><small>3</small></li>
  
    <li><a href="/categories/webpack/">webpack</a><small>1</small></li>
  
    <li><a href="/categories/双向数据绑定/">双向数据绑定</a><small>1</small></li>
  
    <li><a href="/categories/数据交互/">数据交互</a><small>1</small></li>
  
    <li><a href="/categories/构建工具/">构建工具</a><small>1</small></li>
  
    <li><a href="/categories/正则表达式/">正则表达式</a><small>1</small></li>
  
    <li><a href="/categories/油田/">油田</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">Tag-Cloud</h3>
  <div class="entry">
    <a href="/tags/AJAX/" style="font-size: 10px;">AJAX</a> <a href="/tags/AngularJS特性/" style="font-size: 10px;">AngularJS特性</a> <a href="/tags/CSS3/" style="font-size: 10px;">CSS3</a> <a href="/tags/ES6语法/" style="font-size: 10px;">ES6语法</a> <a href="/tags/JavaScript/" style="font-size: 12.5px;">JavaScript</a> <a href="/tags/Session/" style="font-size: 10px;">Session</a> <a href="/tags/Token/" style="font-size: 10px;">Token</a> <a href="/tags/Vuejs/" style="font-size: 17.5px;">Vuejs</a> <a href="/tags/Vue事件处理/" style="font-size: 10px;">Vue事件处理</a> <a href="/tags/Vue列表渲染及条件渲染/" style="font-size: 10px;">Vue列表渲染及条件渲染</a> <a href="/tags/Vue实例详解，Vue生命周期/" style="font-size: 10px;">Vue实例详解，Vue生命周期</a> <a href="/tags/Vue的入门简介/" style="font-size: 10px;">Vue的入门简介</a> <a href="/tags/Vue的数据绑定/" style="font-size: 10px;">Vue的数据绑定</a> <a href="/tags/Vue组件化/" style="font-size: 10px;">Vue组件化</a> <a href="/tags/Vue组件间通信/" style="font-size: 10px;">Vue组件间通信</a> <a href="/tags/Vue综合实战项目/" style="font-size: 10px;">Vue综合实战项目</a> <a href="/tags/Vue路由/" style="font-size: 10px;">Vue路由</a> <a href="/tags/angularjs/" style="font-size: 15px;">angularjs</a> <a href="/tags/angular介绍/" style="font-size: 10px;">angular介绍</a> <a href="/tags/angular服务/" style="font-size: 10px;">angular服务</a> <a href="/tags/angular路由/" style="font-size: 10px;">angular路由</a> <a href="/tags/angular过滤器/" style="font-size: 10px;">angular过滤器</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/eslint/" style="font-size: 10px;">eslint</a> <a href="/tags/gulp/" style="font-size: 10px;">gulp</a> <a href="/tags/javaScript指南/" style="font-size: 10px;">javaScript指南</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/js对象继承方式/" style="font-size: 10px;">js对象继承方式</a> <a href="/tags/requirejs/" style="font-size: 10px;">requirejs</a> <a href="/tags/seajs/" style="font-size: 10px;">seajs</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/任丘/" style="font-size: 10px;">任丘</a> <a href="/tags/前端构建工具/" style="font-size: 12.5px;">前端构建工具</a> <a href="/tags/前端框架/" style="font-size: 20px;">前端框架</a> <a href="/tags/前端框架，angular指令/" style="font-size: 10px;">前端框架，angular指令</a> <a href="/tags/前端模块化/" style="font-size: 10px;">前端模块化</a> <a href="/tags/前端规范工具/" style="font-size: 10px;">前端规范工具</a> <a href="/tags/双向数据绑定/" style="font-size: 10px;">双向数据绑定</a> <a href="/tags/对象原型/" style="font-size: 10px;">对象原型</a> <a href="/tags/打包压缩工具/" style="font-size: 10px;">打包压缩工具</a> <a href="/tags/正则表达式/" style="font-size: 12.5px;">正则表达式</a> <a href="/tags/跨域，前后端数据交互/" style="font-size: 10px;">跨域，前后端数据交互</a>
  </div>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 蒙长圆
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



</body>
</html>

